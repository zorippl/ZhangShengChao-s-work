## 第9章、通过手机实现设备的远程控制

### 9.1 概述
本章将以接入云服务 RainMaker 为例，介绍开发 Android/iOS 应用实现手机对设备的 BLE 配网以及远程控制  

#### 9.1.1 接口文档和开源项目
- 云端接口文档: https://swaggerapis.rainmaker.espressif.com  
- Android 客户端开源项目: https://github.com/espressif/esp-rainmaker-android  
- iOS客户端开源项目: https://github.com/espressif/esp-rainmaker-ios  

#### 9.1.2 HTTPS 基础介绍
客户端与云端的通信采用的协议为 **HTTPS**    

##### 9.1.2.1 什么是 HTTPS 协议
HTTPS 即**超文本传输安全协议**，英语：HyperText Transfer Protocol Secure, 是一种通过计算机网络进行安全通信的传输协议。HTTPS 经由 **HTTP** 进行通信，但利用 SSL/TLS 来加密数据包。HTTPS 开发的主要目的，是对提供网站服务器的身份认证，保护交换资料的隐私与完整性。

##### 9.1.2.1 什么是 HTTP 协议
HTTP 即**超文本传输协议**，英语：HyperText Transfer Protocol, 是一种用于分布式、协作式和超媒体信息系统的应用层协议，是万维网数据通信的基础.

##### 9.1.2.3 协议例子
- 客户端请求    
```http
GET / HTTP/1.1
Host: www.espressif.com
```
- 服务器应答    
```http
HTTP/1.1 200 OK
Server: Apache
X-Content-Type-Options: nosniff, nosniff
Expires: Sun, 19 Nov 1978 05:00:00 GMT
Cache-Control: no-cache, must-revalidate
Content-Language: en
Connection: close
Transfer-Encoding: chunked
Content-Type: text/html; charset=utf-8
```
紧跟一个空行，然后由 HTML 格式文本组成乐鑫的主页

#### 9.1.3 JSON 基础介绍
客户端与云端通信采用的数据格式为 JSON     

##### 9.1.3.1 什么是 JSON
JSON, 全称 JavaScript Object Notation, 是一种轻量级资料交换格式。其内容由属性和值所组成，因此也有易于阅读和处理的优势。

##### 9.1.3.2 JSON 的基本数据类型
- 数值：十进制数，不能有前导0，可以为负数，可以有小数部分。还可以用e或者E表示指数部分。不能包含非数，如NaN。不区分整数与浮点数。JavaScript用双精度浮点数表示所有数值。
- 字符串：以双引号""括起来的零个或多个Unicode码位。支持反斜杠开始的转义字符序列。
- 布尔值：表示为true或者false。
- 数组：有序的零个或者多个值。每个值可以为任意类型。序列表使用方括号[，]括起来。元素之间用逗号,分割。形如：[value, value]
- 对象：若干无序的“键-值对”(key-value pairs)，其中键只能是字符串[1]。建议但不强制要求对象中的键是独一无二的。对象以花括号{开始，并以}结束。键-值对之间使用逗号分隔。键与值之间用冒号:分割。
- 空值：值写为 null

##### 9.1.3.3 数据格式例子
```json
{
    "name": "Tom",
    "sex": "male",
    "age": 27,
    "job": {
        "company": "Espressif",
        "department": "Software",
        "position": "Engineer"
    },
    "fullTime": true,
    "phoneNumber": [
        {
            "type": "home",
            "number": "33245678"
        },
        {
            "type": "mobile",
            "number": "13012349876"
        }
    ]
}
``` 

#### 9.1.4 客户端如何发起通信请求
Android 和 iOS 原生就对 HTTPS 和 JSON 进行了很好的支持    
- Android 使用 `JSONObject` 和 `JSONArray` 就可以对 JSON 的对象和数组进行组装和解析，使用 `HttpURLConnection` 可以发起 HTTP 请求
- iOS 使用 `NSJSONSerialization` 对 JSON 进行数据的组装和解析，使用 `URLSession` 可以发起 HTTP 请求
    
或者您也可以使用第三方 HTTP 库
